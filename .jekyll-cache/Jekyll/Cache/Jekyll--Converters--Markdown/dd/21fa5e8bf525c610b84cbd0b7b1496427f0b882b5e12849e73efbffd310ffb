I"ñ<h3 id="62-åœ¨ä»£ç ä¸­ä½¿ç”¨æ ˆ">6.2 åœ¨ä»£ç ä¸­ä½¿ç”¨æ ˆ</h3>

<p>è®©æˆ‘ä»¬åˆ©ç”¨æ ˆï¼Œå°†ç¨‹åºä¸­å®šä¹‰çš„æ•°æ®é€†åºå­˜æ”¾ã€‚</p>

<p>å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code class="language-x86asm">assume cs:codesg
codesg segment
    
    dw 0123h, 0456h, 0789h, 0abch, 0defh, 0fedh, 0cbah, 0987h

    dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ;è¿™é‡Œdwå®šä¹‰äº†16ä¸ªå­—å‹æ•°æ®ï¼Œåœ¨ç¨‹åºåŠ åœ¨åï¼Œå°†å–å¾—16ä¸ªå­—
    ;çš„å†…å­˜ç©ºé—´ï¼Œå­˜æ”¾è¿™16ä¸ªæ•°æ®ã€‚åé¢å°†è¿™æ®µç©ºé—´å½“ä½œæ ˆæ¥ä½¿ç”¨

start:  mov ax, cs
        mov ss, ax
        mov sp, 30h  ;æ ˆé¡¶ss:spæŒ‡å‘cs:30h 
        ; è¿™é‡Œss:spæŒ‡å‘16 + 32 = 48 = 30h

        mov bx, 0
        mov cx, 8
    s:  push cs:[bx]
        add bx, 2
        loop s      ;0~15å•å…ƒä¸­çš„8ä¸ªå­—å‹æ•°æ®ä¸€æ¬¡å…¥æ ˆ
        mov bx, 0
        mov cx, 8
    s0: pop cs:[bx]
        add bx, 2
        loop s0     ;ä¾æ¬¡å‡ºæ ˆ8ä¸ªå­—å‹æ•°æ®åˆ°ä»£ç æ®µ0~15å•å…ƒä¸­

        mov ax, 4c00h
        int 21h

codesg ends
end start
</code></pre>

<p>è¿™é‡Œå°†ä»¥ä¸Šä»£ç å¯¹æ¯”ä¸‹é¢è¿™ä¸ªä»£ç ï¼Œå®ç°0:0~0:15å•å…ƒä¸­çš„å†…å®¹çš„æ­£åºæ”¹å†™ï¼Œé€šç”¨åˆ©ç”¨æ ˆæ¥å®Œæˆï¼š</p>

<pre><code class="language-x86asm">assume cd:codesg
codesg segment
    dw 0123h, 0456h, 0789h, 0abch, 0defh, 0fedh, 0cbah, 0987h
    dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
start:  mov ax, cs  ;è¿™é‡Œå¯ä»¥mov ax, codesg
        mov ss, ax
        mov sp, 24h ;æŒ‡å‘æ ˆé¡¶

        mov ax, 0
        mov ds, ax
        mov bx, 0

        mov cx, 8
    s:  push [bx]
        pop cs:[bx] ;ä¹Ÿå¯ä»¥pop ss:[bx], å› ä¸ºä»£ç æ®µè¿™æ˜¯ä¸æ ˆä¸­æ•°æ®ä¸€è‡´
        add bx, 2
        loop s

        mov ax, 4c00h
        int 21h
codesg ends
end start
</code></pre>

<p>å¯¹æ¯”å’Œç¬¬ä¸€ä¸ªç¨‹åºçš„å·®åˆ«ï¼Œè¿™ä¸ªç¨‹åºæ˜¯å…¥æ ˆä¸€è¡Œä»£ç ç›´æ¥å‡ºæ ˆåˆ°è¿™ä¸€è¡Œï¼Œä¿è¯ç¨‹åºçš„æ­£æ–¹å‘ã€‚</p>

<h3 id="63-å°†æ•°æ®ä»£ç æ ˆæ”¾å…¥ä¸åŒçš„æ®µ">6.3 å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ</h3>

<p>ç›®å‰, å¦‚æœæˆ‘ä»¬å¯¹äºæ•°æ®ï¼Œä»£ç ï¼Œæ ˆå…¨éƒ¨å­˜æ”¾åœ¨ä»£ç æ®µä¸­æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p>

<ol>
  <li>éå¸¸æ··ä¹±</li>
  <li>æ•°æ®ã€æ ˆå’Œä»£ç éœ€è¦çš„ç©ºé—´å¦‚æœè¶…è¿‡64KBï¼Œå°±æ— æ³•æ”¾åœ¨ä¸€ä¸ªæ®µä¸­(x86cpu)</li>
</ol>

<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼š</p>

<pre><code class="language-x86asm">assume cs:code, ds:data, ss:stack
data segment
    dw 0123h, 0456h, 0789h, 0abch, 0defh, 0fedh, 0cbah, 0987h
stack segment
    dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 
stack ends
code segment
start: mov ax, stack
       mov ss, ax
       mov sp, 20h

       mov ax, data
       mov ds, ax  ;ds:bxæŒ‡å‘dataæ®µ

       mov bx, 0

       mov cs, 8
s:     push [bx]
       add bx, 2
       loop s

       mov bx, 0

       mov cx, 8

s0:    pop [bx]
       add bx, 2
       loop s0

       mov ax, 4c00h
       int 21h

code ends
end start
</code></pre>

<p>æ³¨æ„ï¼š</p>

<ol>
  <li>æºç¨‹åºä¸­â€dataâ€, â€œcodeâ€, â€œstackâ€å‡åªæ˜¯æˆ‘ä»¬çš„å‘½åï¼ŒCPUä¸ä¼šè¯†åˆ«</li>
  <li>ä¼ªæŒ‡ä»¤ä¸­<code class="language-plaintext highlighter-rouge">assume cscode, ds:data, ss:stack</code>å°†cs, ds, ssåˆ†åˆ«ä¸code, data, stackç›¸è¿ã€‚ä½†å…¶æ˜¯ä¼ªæŒ‡ä»¤ï¼Œæ˜¯ç”±ç¼–è¯‘å™¨æ‰§è¡Œçš„ï¼ŒcpuåŒæ ·æ— æ³•è¯†åˆ«</li>
  <li>CPUçš„è¯†åˆ«å…¶å®é çš„æ˜¯æ§åˆ¶cs, ds, ssçš„ç›¸å…³åœ°å€æ¥è¯†åˆ«ç›¸åº”çš„æ•°æ®ä¿¡æ¯çš„</li>
</ol>

:ET